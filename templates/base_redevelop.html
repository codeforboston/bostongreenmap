<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Boston Green Space - Find Your Space</title>
    <!-- Bootstrap -->
    <link href='http://fonts.googleapis.com/css?family=Domine:400,700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Istok+Web:400,700' rel='stylesheet' type='text/css'>

    <link href="{{ STATIC_URL }}css/bootstrap.min.css" rel="stylesheet">
    <link href="{{ STATIC_URL }}css/custom.css" rel="stylesheet">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  
  <body>
    <nav class="navbar navbar-default" id="boston-green-navbar-container" role="navigation">
      <div class="container-fluid" id="boston-green-navbar-content">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <div class="logo"></div>
          <div class="sitename"><b><a href="#" id="index">BostonGreenSpace</a></b>.org</div>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse navbar-right" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav" id="boston-green-navbar">
            <li class="navlinks"><a id="about" href="#">About</a></li>
            <li class="navlinks"><a id="mission" href="#">Mission</a></li>
            <li class="navlinks"><a id="contact" href="#">Contact</a></li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>
    <div id="viewport">

      <div class="template-all" id="template-results">

        <div class="tiles">
        </div>
      </div>

      <div class="template-all" id="template-about">
        About
      </div>

      <div class="template-all" id="template-mission">
        Mission
      </div>

      <div class="template-all" id="template-contact">
        Contact
      </div>

      <div class="template-all" id="template-results">
      </div>

      <div class="template-all" id="template-detail">
        <div class="park-info">
          <img class="park-picture" src="">
          <div class="park-name"></div>
          <div class="description"></div>
        </div>
        <center style="margin-top: 20px">
        <div class="icon-container">
           <img class="icon" src="{{ STATIC_URL }}img/Soccer/icon.svg">
        </div>
        <div class="icon-container">
           <img class="icon" src="{{ STATIC_URL }}img/Basketball/icon.svg">
        </div>
        <div class="icon-container">
           <img class="icon" src="{{ STATIC_URL }}img/Monument/icon.svg">
        </div>
        <div class="icon-container">
           <img class="icon" src="{{ STATIC_URL }}img/Grilling/icon.svg">
        </div>
        <center>
                  <div class="owner"></div>
        <div class="images"></div>
        <div class="access"></div>

      </div>

      <div id="template-index">
        <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
          <div class="row">
            <div class="floating-text col-md-6">
              <h1>Find your space.</h1>
              <div class="row">
                <div class="btn-group col-md-12">
                  <select data-placeholder="Select Your Neighborhood" class="form-control" style="color: #000000" id="neighborhoods">
                    <option value="">All Neighborhoods</option>
                    {% for n in neighborhoods %}
                      <option value="{{ n.pk }}">{{ n.name }}</option>
                    {% endfor %}
                  </select>
                </div>
              </div>
              <div class="row">
                <div class="btn-group col-md-12">
                  <select data-placeholder="Select Your Activity" class="form-control" style="color: #000000" id="facility__activity">
                    <option value="">All Activities</option>
                    {% for a in activities %}
                      <option value="{{ a.pk }}">{{ a.name }}</option>
                    {% endfor %}
                  </select>
                </div>
              </div>
              <div class="gobutton" id="filter-select">GO</div>
              <div id="no-results">No results!</div>
            </div>  
          </div>
        
          <!-- Indicators -->
          <ol class="carousel-indicators">
            <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
            <li data-target="#carousel-example-generic" data-slide-to="1"></li>
            <li data-target="#carousel-example-generic" data-slide-to="2"></li>
          </ol>

          <!-- Wrapper for slides -->
          <div class="carousel-inner" id="carousel-images-container">
            <div class="item active">
              <img class="carousel-image" src="{{ STATIC_URL }}/img/4-JamaicaPondJP.JPG" alt="...">
              <div class="carousel-caption">
              </div>
            </div>
            <div class="item">
              <img class="carousel-image" src="{{ STATIC_URL }}/img/13-OMalleyWaterfrontPark-Chelsea.JPG" alt="...">
              <div class="carousel-caption">
              </div>
            </div>
            <div class="item">
              <img class="carousel-image" src="{{ STATIC_URL }}/img/Nkraft (Charles River Bike Path Sunset 1).jpg" alt="...">
              <div class="carousel-caption">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
<div class="footer">
  <div class="footer-text">What people are saying</div>

<div class="twitter-container">
<a class="twitter-timeline" width="500" height="300" 
   href="https://twitter.com/twitterapi" data-widget-id="YOUR-WIDGET-ID-HERE">Tweets by @twitterapi</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</div>

<div class="footer-right">
<div class="footer-text">Latest Park Pic</div> 
<img src="http://www.bostongreenmap.org/media/cache/ee/23/ee23dc9479f04d0b18545dee97f0bd77.jpg">
</div>

<div class="footer-url footer-text"><b>BostonGreenMap.org</b></div>
<div class="footer-address footer-text">1220 Washington Street | West Newton, Massachussetts 02465</div>
<div class="footer-number footer-text">617.555.5555 | info@bostongreenmap.org</div> 

<div class="footer-social">
  <div class="footer-text">Get social with us</div>
  <div>
  <div class="white-circle"></div>
  <div class="white-circle"></div>
  <div class="white-circle"></div>
  <div class="white-circle"></div>
  </div>
</div>
</div>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script>

      var LINKS = [
        {
          name: "about"
        },
        {
          name: "mission"
        },
        {
          name: "contact"
        },
        {
          name: "index"
        },
        {
          name: "results"
        },
        {
          name: "detail"
        }
      ];

      $('#filter-select').on('click', function(d) {
        var neighborhood = $('#neighborhoods option:selected').val();
        var activity = $('#facility__activity option:selected').val();

        var string = 'parks/search?';

        if (neighborhood) {
          string = string + 'neighborhoods=' + neighborhood + '&';
        }

        if (activity) {
          string = string + 'facility__activity=' + activity;
        }

        $.getJSON(string, function(d,i) {
          window.searchResults = d;
          if (jQuery.isEmptyObject(window.searchResults)) {
            $('#no-results').css('display','block');
          } else {
            $('#no-results').css('display','none');
            $('#template-results').empty();
            switchPage("results");
            addResults(window.searchResults);
          }
        });
      });

      $.getJSON('', function(d,i) {
        // populateCarousel(d);
      });


      function addImageToViewer(caption, src, key, name, result_id) {
        var container = $('<div class="tile">');
        var img = $('<img class="image-result-tile" src="' + src +'" title="' + caption +'">');
        var link = $('<a id="detail" href="#">');
        link.append(img);
        var nameEl = $('<div class="name">' + name + '</div>');
        container.append(link);
        container.append(nameEl);
        link.attr('result_id', key);
        $('#template-results').append(container);
      }

      function addResults(results) {
        for (var key in results) {

          if (results.hasOwnProperty(key)) {
            var jsonResult = results[key];

            if (jsonResult) {

              var images = jsonResult['images'];
              if (images.length !== 0) {

                images = images[0];
                addImageToViewer(images['caption'], images['src'], key, jsonResult['name']);
              } else {
                addImageToViewer("caption", "http://openclipart.org/image/800px/svg_to_png/166402/winter15-sunset-Jul-2011-royal-park.png", key, jsonResult['name'])
              }
            }
          }
        }
        addClickListeners();
      }

      function populateResults (results) {
        for (var prop in results) {
          if (results.hasOwnProperty(prop)) {
            $('#template-results').append("Name: " + (results[prop]).name + "<br />");
          }
        }
      }
      function addClickListeners() {
        $('a').on('click', function(event) {
          switchPage(event.currentTarget.id, event.currentTarget.getAttribute('result_id'));
        });
      }

      function initializeDetails(result) {
         var name = result['name'];
         var description = result['description'];
         var owner = result['owner'];
         var images = result['images'];
         var access = result['access'];
         $('#template-detail .description').html(description);
         $('#template-detail .park-name').html(name);
         $('#template-detail .park-picture').attr('src', '{{ STATIC_URL }}/img/13-OMalleyWaterfrontPark-Chelsea.JPG');
         $('#template-detail .owner').html(owner);
         $('#template-detail .images').html(images);
         $('#template-detail .access').html(access);
      }

      function switchPage (resource, resultID) {
        window.currentResult = resultID;
        LINKS.forEach(function(d) {
          if (resource == d.name) {
            $("#template-" + d.name).show();
            if (d.name == 'detail') {
              initializeDetails(window.searchResults[window.currentResult]);
            }
            addClickListeners();
          } else {
            $("#template-" + d.name).hide();
          }
        });
      }

      function populateCarousel (response) {
        var images = pullImages(response);
        images.splice(3);

        var count = 0;
        images.forEach(function(d) {
          var active = "";
          if (count == 0) {
            active = "active";
          } else {
            active = "";
          }

          var image = '<div class="item ' + active + '"><img class="carousel-image" src="' + d.src + '" /><div>';
          $('#carousel-images-container').append(image)
          count++;
        });
      }

      function pullImages (object) {
        var strippedObjects = [];
        for (var prop in object) {
          if (object[prop].images.length > 0) {
            strippedObjects.push({ src: object[prop].images[0].src, url: object[prop].url })
          }
        };
        return strippedObjects;
      }


    addClickListeners();
    </script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="{{ STATIC_URL }}libs/jquery/jquery.url.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}libs/jquery/jquery.slides.min.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}/js/bootstrap.min.js"></script>
  </body>
</html>